/* MapClient.module.css */

/* ---------------------------------------------------------
   PAGE
   --------------------------------------------------------- */

.page {
  height: 100svh;
  background: var(--bg);
  color: var(--ink);
  display: flex;
  flex-direction: column;
  overflow: hidden;     /* ✅ lås siden */
}

/* ---------------------------------------------------------
   DESKTOP BODY (split view)
   --------------------------------------------------------- */

.desktopBody {
  flex: 1;
  min-height: 0;
  display: grid;
    overflow: hidden;   /* ✅ vigtig */
  grid-template-columns: 1fr; /* mobile default */
}

/* left panel hidden on mobile */
.desktopPanel {
  display: none;
}

/* right map area wrapper */
.mapShell {
  position: relative;
  min-height: 0;
  overflow: hidden;
}

/* Leaflet container must fill parent */
.mapShell :global(.leaflet-container) {
  height: 100% !important;
  width: 100% !important;
}

/* ---------------------------------------------------------
   DESKTOP PANEL
   --------------------------------------------------------- */

.panelInner {
  height: 100%;
  min-height: 0;
  overflow: auto;
  padding: 14px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.panelHeader {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.panelTitle {
  font-weight: 850;
  font-size: 13px;
  opacity: 0.9;
}

.clearBtn {
  border: var(--stroke) solid var(--glassLine);
  background: var(--glassBg);
  color: var(--ink);
  border-radius: 12px;
  padding: 8px 10px;
  font-weight: 850;
  font-size: 12px;
  box-shadow: var(--shadow-1);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  cursor: pointer;
}

.clearBtn:hover {
  transform: translateY(-1px);
}

.desktopListWrap {
  /* Make MapSheet behave like panel content */
  position: relative;
}

/* ---------------------------------------------------------
   MOBILE DOCK (sheet + peek overlays)
   --------------------------------------------------------- */

/* Mobile dock ON by default */
.mobileDock {
  position: absolute;
  inset: 0;
  pointer-events: none; /* wrapper shouldn't block the map */
}

.mobileDock > * {
  pointer-events: auto; /* actual UI is clickable */
}

/* Peek card (mobile) – lies above sheet */
.peekWrap {
  position: absolute;
  left: 12px;
  right: 12px;
  bottom: calc(
    var(--bottom-nav-h, 92px) + 24px + env(safe-area-inset-bottom) + 82px
  );
  z-index: 920;
}

.sheetWrap {
  position: absolute;
  left: 12px;
  right: 12px;
  bottom: calc(var(--bottom-nav-h, 92px) + 24px + env(safe-area-inset-bottom));
  z-index: 910;
  transform: translateY(-6px);
}

/* Bonus: small screens tighter */
@media (max-width: 420px) {
  .peekWrap {
    left: 10px;
    right: 10px;
  }

  .sheetWrap {
    left: 10px;
    right: 10px;
    bottom: calc(var(--bottom-nav-h, 92px) + 22px + env(safe-area-inset-bottom));
    transform: translateY(-5px);
  }
}

/* ---------------------------------------------------------
   DESKTOP BREAKPOINT
   --------------------------------------------------------- */

@media (min-width: 1024px) {
  .desktopBody {
    grid-template-columns: 420px 1fr;
  }

  .desktopPanel {
    display: block;
    min-height: 0;
    border-right: 1px solid var(--glassLine);
    background: color-mix(in srgb, var(--bg) 92%, #000 8%);
  }

  /* Turn OFF mobile dock on desktop */
  .mobileDock {
    display: none;
  }

  /* On desktop, MapSheet should not animate/float like a sheet.
     We can't change MapSheet internals here, but we can neutralize a bit:
     If MapSheet.module.css uses position/fixed, you should keep it scoped there.
  */
}

/* ---------------------------------------------------------
   TOASTS
   --------------------------------------------------------- */

.toastError,
.toastInfo {
  position: absolute;
  left: 12px;
  right: 12px;
  top: 12px;
  z-index: 950;
  border-radius: 14px;
  padding: 10px 12px;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: var(--stroke) solid var(--glassLine);
  background: var(--glassBg);
  box-shadow: var(--shadow-2);
  font-weight: 850;
  font-size: 12px;
}

.toastError {
  border-color: color-mix(in srgb, #ef4444 45%, var(--glassLine));
}

.toastInfo {
  border-color: color-mix(in srgb, var(--accent) 35%, var(--glassLine));
}

@media (min-width: 1024px){
  .desktopPanel{
    display: flex;       /* ✅ gør det til en låst container */
    flex-direction: column;
    min-height: 0;
    overflow: hidden;    /* ✅ scroll kun i panelInner */
  }

  .panelInner{
    flex: 1;
    height: auto;        /* ✅ drop height:100% (kan give weirdness i flex) */
    min-height: 0;
    overflow: auto;
  }
}

/* ---------------------------------------------------------
   MOBILE SCROLL LOCK (kun på map route)
   Når sheet er expanded: lås page/map, scroll kun inde i sheet
   --------------------------------------------------------- */

@media (max-width: 1023px) {
  .page[data-sheet-open="1"] {
    /* ✅ stop page-scroll rubber band */
    overscroll-behavior: none;
    touch-action: none; /* vigtig: siden skal ikke scrolle */
  }

  .page[data-sheet-open="1"] .mapShell {
    touch-action: none;
  }

  /* Allow sheet to handle touch/scroll */
  .page[data-sheet-open="1"] .sheetWrap {
    touch-action: pan-y;
  }
}

/* src/app/[locale]/map/MapClient.module.css */

/* ... behold dine eksisterende styles ... */

.mapShell{
  position: relative;
}

/* ✅ rail under insights, over map, men ikke som stort overlay */
.targetsRailWrap{
  position: relative;
  margin: 10px 12px 0;
  z-index: 2;
}

/* hvis dine toasts ligger under, så hold dem over */
.toastError,
.toastInfo{
  position: absolute;
  left: 12px;
  right: 12px;
  bottom: 110px;
  z-index: 5;
}

/* --- Targets rail: gør den lille, fast og “chip”-agtig --- */
.targetsRailSlot{
  position: absolute;
  left: 12px;
  right: 12px;
  top: 118px;                 /* under topbar + insight strip (tweak) */
  z-index: 30;

  /* hård begrænsning så den aldrig kan blive stor */
  max-height: 84px;
  pointer-events: none;       /* så man stadig kan pan/zoome kortet */
}

/* TargetsBar skal stadig kunne klikkes */
.targetsRailSlot :global(*) {
  pointer-events: auto;
}

/* Tving TargetsBar til at opføre sig som en lille rail */
.targetsRailSlot :global(.wrap),
.targetsRailSlot :global(.bar),
.targetsRailSlot :global(.rail){
  height: 84px;
  max-height: 84px;
}

/* Hvis TargetsBar har en title/header – gør den tiny eller skjul */
.targetsRailSlot :global(.title),
.targetsRailSlot :global(h3){
  font-size: 12px;
  opacity: 0.75;
  margin: 0 0 6px;
}

/* Tving cards/chips ned i størrelse */
.targetsRailSlot :global(.item),
.targetsRailSlot :global(.card){
  border-radius: 14px;
  padding: 10px 12px !important;
  min-height: 0 !important;
  height: 66px !important;     /* selve chip-højden */
  backdrop-filter: blur(10px);
}

/* tekst ned i størrelse */
.targetsRailSlot :global(.label){
  font-size: 13px !important;
  line-height: 1.05 !important;
  font-weight: 800;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.targetsRailSlot :global(.metric),
.targetsRailSlot :global(.hint){
  font-size: 12px !important;
  opacity: 0.75;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* For mobile: giv lidt mere top så den ikke konflikter med chips/insights */
@media (max-width: 640px){
  .targetsRailSlot{
    top: 110px;
    max-height: 78px;
  }

  .targetsRailSlot :global(.item),
  .targetsRailSlot :global(.card){
    height: 60px !important;
    padding: 9px 11px !important;
  }

  .targetsRailSlot :global(.label){
    font-size: 12.5px !important;
  }
}

.forageBar{
  padding: 8px 12px 0;
}

.forageChip{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid var(--line);
  background: color-mix(in srgb, var(--panel) 78%, transparent);
  color: var(--ink);
  font-weight: 800;
  font-size: 12px;
  line-height: 1;
  max-width: 100%;
}

.forageChip:active{ transform: translateY(1px); }

.forageLabel{
  color: var(--muted);
  font-weight: 700;
}

.forageValue{
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 60vw;
}

.forageX{
  opacity: .7;
  font-weight: 900;
}
